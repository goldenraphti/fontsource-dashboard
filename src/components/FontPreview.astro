---
import { Font } from 'astro:assets';
import type {FontType} from '../content/fonts-list';
import Bookmark from '../icons/bookmark.svg';
import BookmarkSolid from '../icons/bookmark-solid.svg';
import Star from '../icons/star.svg';
import StarFilled from '../icons/star-filled.svg';

interface Props {
  fontToPreview: FontType
}

const { fontToPreview } = Astro.props;
---
<Font cssVariable={fontToPreview.cssVariable} preload />
<details font-name={fontToPreview.fontName} font-categories={fontToPreview.fontCategories.join(", ")} font-tags={fontToPreview?.tags?.join(", ") ?? ""} >
  <summary>
    <p style=`--font-family: var(${fontToPreview.cssVariable})`>This is a preview of the font "{fontToPreview.fontName}"</p>
  </summary>
  <ul>
    <li><a href={fontToPreview.urlPreview}>Preview ðŸ”—</a></li>
    <li><strong>Categories:</strong> {fontToPreview.fontCategories.join(", ")}</li>
    {fontToPreview?.tags?.length && (<li><strong>Tags:</strong> {fontToPreview.tags?.join(", ")}</li>)}
    <div class="favourites-and-collections-actions">
      <button data-action="add-to-favourites" data-is-favourite="false"><span class="visually-hidden">Add to favourites</span>
        <span class="is-not-favourite"><Star /></span>
        <span class="is-favourite"><StarFilled /></span>
      </button>
      <button data-action="add-to-collection"><span class="visually-hidden">Add to collections</span><Bookmark /></button>
    </div>
  </ul>
</details>

<style>
  details {
    --outer-inline-padding: 2rem;
    --outer-block-padding: 1.5rem;
    width: fit-content;
    border: 1px solid var(--bg-color-accent);
    border-radius: 0.5rem;
    height: auto;

    summary {
      padding: var(--outer-block-padding) var(--outer-inline-padding);
      margin: 0;
      font-size: var(--font-size-preview, 1.5rem);
      font-weight: var(--font-weight-preview, 400);
      font-style: var(--font-italic-preview, normal);
      cursor: pointer;
      list-style: none;

      & p {
        font-family: var(--font-family);
        margin: 0;
        text-align: start;
      }

    }

    &::details-content {
      opacity: 0;
      block-size: 0;
      overflow-y: clip;
      transition: content-visibility 0.2s allow-discrete, opacity 0.2s, block-size 0.2s;
      transition-timing-function: ease-in-out;
      padding-inline: var(--outer-inline-padding);
    }

    & ul {
      display: flex;
      gap: 1rem;
      flex-wrap: wrap;
    }

    &[open]::details-content {
      opacity: 1;
      block-size: auto;
      overflow: clip; /* Clip off contents while animating */
      padding-block-end: var(--outer-block-padding);
    }

    div.favourites-and-collections-actions {
      display: flex;
      gap: 1rem;

      & button {
        width: 2rem;
        height: 2rem;
        padding: 0;
        background: none;
        border: none;
        aspect-ratio: 1 / 1;
        display: grid;
        place-items: center;

        & svg {
          opacity: 0.8;
        }

        &:hover {
          cursor: pointer;
          background-color: color-mix(in oklab, var(--bg-color-accent), transparent 70%);

          svg {
            scale: 1.1;
            opacity: 1;
          }
        }

        &[data-is-favourite="true"] {
          .is-favourite {
            display: inline;
          }
          .is-not-favourite {
            display: none;
          }
        }
        &[data-is-favourite="false"] {
          .is-favourite {
            display: none;
          }
          .is-not-favourite {
            display: inline;
          }
        }
      }

    }
  }
</style>